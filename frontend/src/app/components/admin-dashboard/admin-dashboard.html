<div class="liquid-container admin-grid">
  
  <div class="card">
    <div class="card-header">
      <h3><span class="material-icons">apartment</span> Departments</h3>
    </div>
    
    <div class="card-controls">
      <form [formGroup]="addDepartmentForm" (ngSubmit)="addDepartment()" class="add-row">
        <input placeholder="Name" formControlName="name">
        <button class="btn-primary btn-icon" [disabled]="addDepartmentForm.invalid">
          <span class="material-icons">add</span>
        </button>
      </form>
    </div>

    <div class="card-body-scroll">
      <div class="list-item" *ngFor="let d of departments">
        <span>{{d.name}}</span>
        <button class="btn-danger btn-icon" (click)="deleteDepartment(d.id)">
          <span class="material-icons">delete</span>
        </button>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3><span class="material-icons">medical_services</span> Services</h3>
    </div>

    <div class="card-controls">
      <form [formGroup]="addServiceForm" (ngSubmit)="addService()">
        <div style="margin-bottom: 8px;">
          <select formControlName="departmentId" (change)="onDepartmentChange()" style="width:100%">
            <option value="">Select Department</option>
            <option *ngFor="let d of departments" [value]="d.id">{{d.name}}</option>
          </select>
        </div>
        <div class="add-row">
          <input placeholder="Name" formControlName="name">
          <input placeholder="Price" type="number" formControlName="price" style="width: 70px; flex: none;">
          <button class="btn-primary btn-icon" [disabled]="addServiceForm.invalid">
            <span class="material-icons">add</span>
          </button>
        </div>
      </form>
    </div>

    <div class="card-body-scroll">
      <div class="list-item" *ngFor="let s of filteredServices">
        <div class="doc-item">
          <span class="doc-name">{{s.name}}</span>
          <span class="doc-meta">{{s.price}} RON</span>
        </div>
        <button class="btn-danger btn-icon" (click)="deleteService(s.id)">
          <span class="material-icons">delete</span>
        </button>
      </div>
      <div *ngIf="filteredServices.length === 0" style="padding: 1rem; text-align: center; color: #999; font-size: 0.9rem;">
        Select a department
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3><span class="material-icons">people</span> Doctors</h3>
      <span style="font-size: 0.8rem; color: #666;" *ngIf="editingDoctor">Editing Mode</span>
    </div>

    <div class="card-controls">
      <form [formGroup]="editingDoctor ? editDoctorForm : addDoctorForm" 
            (ngSubmit)="editingDoctor ? updateDoctor() : addDoctor()">
        
        <div class="form-row" style="margin-bottom:8px">
          <input placeholder="First Name" formControlName="firstName">
          <input placeholder="Last Name" formControlName="lastName">
        </div>
        
        <div class="form-row" style="margin-bottom:8px">
          <input placeholder="Email" formControlName="email"> 
          <input placeholder="Phone" formControlName="phone">
        </div>

        <div class="form-row" style="margin-bottom:8px">
           <input type="password" placeholder="Password" formControlName="password">
           <input placeholder="Title" formControlName="title"> 
        </div>

        <div class="form-row" style="margin-bottom:8px">
          <select formControlName="departmentId">
             <option value="">Department</option>
             <option *ngFor="let d of departments" [value]="d.id">{{d.name}}</option>
          </select>
          <select formControlName="timetableTemplate">
             <option value="">Schedule</option>
             <option *ngFor="let t of timetableTemplates" [value]="t">{{t}}</option>
          </select>
        </div>

        <div class="form-row">
          <button type="submit" class="btn-primary" style="flex:1">
            {{ editingDoctor ? 'Update Doctor' : 'Create Doctor' }}
          </button>
          <button type="button" *ngIf="editingDoctor" (click)="closeEdit()" style="background:#eee; color: #333;">
            Cancel
          </button>
        </div>
      </form>
    </div>

    <div class="card-body-scroll">
      <div class="list-item" *ngFor="let doc of doctors">
        <div class="doc-item">
          <span class="doc-name">{{doc.title}} {{doc.user.firstName}} {{doc.user.lastName}}</span>
          <span class="doc-meta">
             <span>{{doc.department?.name}}</span> â€¢ <span>{{doc.user.email}}</span>
          </span>
        </div>
        <div class="actions">
          <button class="btn-icon" (click)="editDoctor(doc)"><span class="material-icons">edit</span></button>
          <button class="btn-danger btn-icon" (click)="deleteDoctor(doc.id)"><span class="material-icons">delete</span></button>
        </div>
      </div>
    </div>
  </div>

</div>